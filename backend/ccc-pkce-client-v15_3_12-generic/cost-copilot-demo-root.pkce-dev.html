<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Cloud Cost Copilot — v15_3 Dev (PKCE)</title>
  <link rel="stylesheet" href="./styles.css">
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script defer src="./config.js"></script>
  <script defer src="./token-ui.js"></script>
  <script defer src="./dashboard.js"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="theme-dark">
  <header class="appbar">
    <div class="brand">
      <img src="./assets/icon.svg" width="22" height="22" alt="icon">
      <span>Cloud Cost Copilot</span>
      <small>v15_3 Dev</small>
    </div>
    <div class="spacer"></div>
    <button class="btn" id="toggleThemeBtn">Light</button>
    <button class="btn" id="loginBtn">Login</button>
    <button class="btn" id="clearBtn">Clear Session</button>
    <button class="btn danger" id="logoutBtn">Logout</button>
  </header>

  <main class="wrap">
    <section class="card">
      <h3>Status</h3>
      <div class="grid cols-3">
        <div><label>Tokens:</label> <span id="tokenStatus">missing</span></div>
        <div><label>Expires:</label> <span id="tokenExpiry">-</span></div>
        <div><label>Scopes:</label> <span id="tokenScopes">-</span></div>
      </div>
    </section>

    <section class="card">
      <div class="card-title">
        <h3>Mode</h3>
        <div class="row gap">
          <label class="chk"><input type="checkbox" id="demoToggle" checked> <span>Demo Mode</span></label>
          <select id="periodSelect">
            <option value="lastMonth">Last Month</option>
            <option value="thisMonth">This Month</option>
            <option value="last7">Last 7 Days</option>
            <option value="ytd" selected>YTD</option>
          </select>
          <button class="btn" id="explainBtn">Explain this spend</button>
        </div>
      </div>
      <div class="grid cols-3" style="margin-top:8px">
        <div class="stat"><label>Total</label><div id="totalVal">$0.00</div></div>
        <div class="stat"><label>Top Service</label><div id="topService">- ($0.00)</div></div>
        <div class="stat"><label>Services</label><div id="svcCount">0</div></div>
      </div>
    </section>

    <section class="card">
      <h3>AI Insight</h3>
      <p id="aiInsight" class="muted">• Total this period is reported above. • Consider rightsizing long‑running EC2, enabling S3 lifecycle to Glacier, and reserving RDS capacity where steady.</p>
    </section>

    <section class="grid cols-2">
      <div class="card">
        <h3>Top Services</h3>
        <ul id="topList" class="list"></ul>
      </div>
      <div class="card">
        <h3>Legend</h3>
        <div id="legend"></div>
      </div>
    </section>

    <section class="grid cols-2">
      <div class="card">
        <h3>Cost by Top Services</h3>
        <canvas id="barChart" height="220"></canvas>
      </div>
      <div class="card">
        <h3>Service Share</h3>
        <canvas id="pieChart" height="220"></canvas>
      </div>
    </section>
  </main>

  <footer class="foot">&copy; Cloud Cost Copilot — Hackathon build v15_3</footer>
<script id="scopes-fallback">
(function(){
  var el = document.getElementById('scopes');
  if (el && (!el.textContent || !el.textContent.trim())){
    el.textContent = 'Not requested';
  }
})();
</script>
</body>
</html>
